Options -MultiViews

<IfModule mod_rewrite.c>
  RewriteEngine On

  # No RewriteBase - Apache auto-determines from .htaccess location
  # Works for both root (/) and subdirectory (/training/online/accessilist/) deployments

  # Allow direct access to existing files and directories
  RewriteCond %{REQUEST_FILENAME} -f [OR]
  RewriteCond %{REQUEST_FILENAME} -d
  RewriteRule ^ - [L]

  # --- Simplified Routing: Remove .php extension ---
  # All PHP files in /php directory can be accessed without .php extension

  # API Routes: /php/api/save → /php/api/save.php
  RewriteRule ^php/api/([^/.]+)$ php/api/$1.php [L]

  # General PHP Routes: /php/filename → /php/filename.php
  # Examples: /php/home → /php/home.php, /php/systemwide-report → /php/systemwide-report.php
  RewriteRule ^php/([^/.]+)$ php/$1.php [L]

  # Root-level clean URLs (no /php/ prefix)
  # Matches: /home, /systemwide-report, /list-report, /mychecklist, etc.
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule ^([^/.]+)$ php/$1.php [L]

  # Fallback: do nothing special; rely on actual files or above rules
</IfModule>

<IfModule mod_headers.c>
  # Disable caching for dynamic content during development
  <FilesMatch "\.(php)$">
    Header set Cache-Control "no-store, no-cache, must-revalidate, max-age=0"
    Header set Pragma "no-cache"
    Header set Expires "0"
  </FilesMatch>
</IfModule>

# Disable caching for all files
<IfModule mod_headers.c>
    Header set Cache-Control "no-cache, no-store, must-revalidate"
    Header set Pragma "no-cache"
    Header set Expires 0
    Header unset ETag
    FileETag None
</IfModule>

# Force browsers to revalidate
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresDefault "access"
</IfModule>
