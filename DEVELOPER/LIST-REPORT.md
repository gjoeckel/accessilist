# AccessiList - List Report

**Document Type:** Backend Developer Code Audit Reference
**Last Updated:** October 20, 2025
**Purpose:** Individual checklist detailed report documentation
**Branch:** cleanup-and-scope-server-files

---

## ğŸ“‹ Overview

The List Report (`/list-report?session=XXX`) displays a detailed view of a single saved checklist with all tasks grouped by checkpoint, showing task text, status, notes, and update timestamps.

### Key Features
- **Single Checklist View** - Detailed report for one session
- **Checkpoint Grouping** - Tasks organized by checkpoint sections
- **Status Indicators** - Visual status badges (Done, Active, Ready)
- **Notes Display** - Read-only scrollable textareas with task notes
- **Progress Tracking** - Done tasks / Total tasks per checkpoint
- **Interactive Filtering** - Filter by status (Done, Active)
- **Back Navigation** - Return to checklist or systemwide report

### Technical Stack
- **Page:** `php/list-report.php`
- **JavaScript:** `js/list-report.js`
- **CSS:** `css/list-report.css`
- **API:** `/php/api/restore?sessionKey=XXX` (provides full session data)

---

## ğŸ—ï¸ Architecture

### Page Structure: `php/list-report.php`

```php
<body class="report-page list-report-page">
  <!-- Loading Overlay -->
  <div id="loadingOverlay">
    <div id="loadingSpinner"></div>
    <div id="loadingText">Loading report...</div>
  </div>

  <!-- Side Panel - Checkpoint Navigation -->
  <nav class="side-panel" aria-expanded="true">
    <ul id="checkpoint-nav">
      <!-- Checkpoint buttons generated by list-report.js -->
    </ul>
    <button class="toggle-strip" aria-label="Toggle side panel">
      <span class="toggle-arrow">â—€</span>
    </button>
  </nav>

  <!-- Sticky Header with Filters -->
  <header class="sticky-header">
    <h1>List Report</h1>

    <!-- Filter Buttons -->
    <div class="filter-buttons" role="group" aria-label="Filter tasks by status">
      <button class="filter-button active" data-filter="all">
        All (<span class="count-all">0</span>)
      </button>
      <button class="filter-button" data-filter="done">
        Done (<span class="count-done">0</span>)
      </button>
      <button class="filter-button" data-filter="active">
        Active (<span class="count-active">0</span>)
      </button>
    </div>

    <!-- Action Buttons -->
    <div class="header-buttons-group">
      <button id="backButton">Back to Checklist</button>
      <button id="refreshButton">Refresh</button>
    </div>
  </header>

  <!-- Main Content -->
  <main role="main">
    <div class="report-section">
      <!-- Checkpoint sections generated by list-report.js -->
    </div>
  </main>

  <!-- Footer -->
  <footer>
    <p>Accessibility Checklists</p>
  </footer>
</body>
```

---

## ğŸ’¾ Data Flow

### 1. Page Load
```
User navigates to /list-report?session=A4K
  â†“
Page loads with empty report section
  â†“
JavaScript extracts session key from URL
  â†“
Fetch /php/api/restore?sessionKey=A4K
  â†“
Server returns complete session data:
  - sessionKey
  - typeSlug
  - metadata (created, lastModified)
  - state (statusButtons, textareas)
  â†“
Load checklist template (JSON)
  â†“
Build report structure:
  - Group tasks by checkpoint
  - Merge template + saved state
  - Create checkpoint sections
  - Create task rows
  â†“
Render to DOM
  â†“
Build side panel navigation
  â†“
Update filter counts
  â†“
Apply default filter (All)
```

### 2. Filter Interaction
```
User clicks filter button (e.g., "Done")
  â†“
Update active filter button
  â†“
Show/hide task rows based on status
  â†“
Hide checkpoints with no visible tasks
  â†“
Update scroll buffer
  â†“
Update side panel (hide/show checkpoint buttons)
```

### 3. Checkpoint Navigation
```
User clicks checkpoint button in side panel
  â†“
Scroll to checkpoint section
  â†“
Focus checkpoint heading
  â†“
Highlight active checkpoint button
```

---

## ğŸ“Š Report Structure

### Checkpoint Section

```html
<section class="report-checkpoint" data-checkpoint="1">
  <h2 id="checkpoint-1-caption" class="report-checkpoint-heading" tabindex="-1">
    Checkpoint 1: Accessibility Basics
  </h2>

  <div class="checkpoint-summary">
    <span class="checkpoint-progress">
      Progress: <strong>2 / 4</strong> tasks done (50%)
    </span>
  </div>

  <table class="report-table">
    <caption class="sr-only">Tasks for Checkpoint 1</caption>
    <thead>
      <tr>
        <th scope="col" class="task-cell">Task</th>
        <th scope="col" class="status-cell">Status</th>
        <th scope="col" class="notes-cell">Notes</th>
      </tr>
    </thead>
    <tbody>
      <!-- Task rows -->
    </tbody>
  </table>
</section>
```

### Task Row

```html
<tr class="report-row" data-task-id="0" data-status="done">
  <td class="task-cell">
    <span class="task-text">Use proper heading structure</span>
  </td>
  <td class="status-cell">
    <span class="status-badge status-done">Done</span>
  </td>
  <td class="notes-cell">
    <textarea
      class="notes-display"
      readonly
      tabindex="-1"
      aria-label="Notes for task: Use proper heading structure"
    >Implemented H1-H6 hierarchy throughout document</textarea>
  </td>
</tr>
```

---

## ğŸ” JavaScript Implementation

**File:** `js/list-report.js`

**Data Flow:**
1. Extract session key from URL
2. Fetch session data from `/php/api/restore`
3. Load checklist template JSON
4. Build checkpoint sections with tasks
5. Create read-only textareas for notes
6. Build side panel navigation
7. Setup filters and counts

**Key Functions:**
- `loadReportData()` - Fetch and load session
- `createCheckpointSection()` - Build checkpoint with progress summary
- `createTaskRow()` - Build task row with status badge + read-only textarea
- `filterReport()` - Show/hide rows by status

**See:** `js/list-report.js` for complete implementation

---

## ğŸ¯ Filtering System

**Filters:** All, Done, Active

**Logic:**
- Filter rows by status (show/hide)
- Hide checkpoints with no visible rows
- Update side panel visibility
- Recalculate scroll buffer

**See:** `js/list-report.js` (setupFilters, filterReport)

---

## ğŸ§­ Side Panel Navigation

**Features:**
- Numbered buttons for each checkpoint
- Click to scroll to checkpoint
- Hide/show based on filter visibility
- Smooth scroll with focus management

**See:** `js/list-report.js` (buildSidePanelNavigation, scrollToCheckpoint)

---

## ğŸ“ Read-Only Scrollable Textareas

**Purpose:** Display task notes in scrollable, read-only textareas

**Attributes:**
- `readonly` (not disabled) - Allows copy/paste, screen reader access
- `tabindex="-1"` - Excluded from tab order
- `aria-label` - Descriptive screen reader label
- `pointer-events: auto` - Enable scrolling

**Styling:** Custom scrollbar, max-height: 200px

**See:** `css/list-report.css` (.notes-display class)

---

## ğŸ“Š Progress Calculation

**Per Checkpoint:** Count done tasks / total tasks, calculate percentage
**Overall:** Sum all done tasks across checkpoints / total tasks

**See:** `js/list-report.js` (calculateCheckpointProgress, calculateOverallProgress)

---

## ğŸ”— Navigation

**Back Button:** Returns to checklist (`/list?type=X&session=Y`)
**Refresh Button:** Reloads page to fetch latest data

**See:** `js/list-report.js` (button event handlers)

---

## ğŸ¨ Status Badges

**Colors:** Done (Green), Active (Yellow), Ready (Gray)

**See:** `css/list-report.css` (.status-badge classes)

---

## âš ï¸ Error Handling

**Handled Errors:**
- Invalid/missing session parameter
- Session not found (404)
- Malformed session key format
- API fetch failures

**Display:** Error overlay with clear message

**See:** `js/list-report.js` (showError, loadReportData)

---

## ğŸ§ª Testing

### Test Coverage

From `proj-test-mirror` (13 list report tests):
- âœ… Valid session handling (HTTP 200)
- âœ… Heading and JS module loading
- âœ… CSS file loading
- âœ… Filter functionality
- âœ… Table structure
- âœ… Back and Refresh buttons
- âœ… Invalid session handling
- âœ… Missing/malformed parameters
- âœ… Filter labels
- âœ… Read-only textarea configuration
- âœ… Scrollbar styling
- âœ… Checkpoint navigation

### Manual Testing Checklist

1. Load `/list-report?session=VALID`
2. Verify all checkpoints displayed
3. Verify task statuses match saved data
4. Verify notes displayed correctly
5. Test filters (All, Done, Active)
6. Test checkpoint navigation
7. Test Back button â†’ returns to checklist
8. Test Refresh button â†’ reloads data
9. Test with invalid session â†’ shows error
10. Test with missing parameter â†’ shows error
11. Test read-only textarea scrolling
12. Test keyboard navigation
13. Test screen reader compatibility

---

## ğŸ“š Related Documentation

- **[GENERAL-ARCHITECTURE.md](GENERAL-ARCHITECTURE.md)** - System overview
- **[SAVE-AND-RESTORE.md](SAVE-AND-RESTORE.md)** - Restore API endpoint
- **[LIST-USER-INTERFACE.md](LIST-USER-INTERFACE.md)** - UI components
- **[SYSTEMWIDE-REPORT.md](SYSTEMWIDE-REPORT.md)** - Aggregate dashboard (links to this page)
- **[TESTING.md](TESTING.md)** - List report test coverage

---

*Document Created: October 20, 2025*
*Synthesized from: user-report-page.md (1494 lines)*
*Status: Complete individual checklist report documentation*
